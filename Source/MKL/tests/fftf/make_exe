##
##               INTEL CORPORATION PROPRIETARY INFORMATION
##  This software is supplied under the terms of a license agreement or
##  nondisclosure agreement with Intel Corporation and may not be copied
##  or disclosed except in accordance with the terms of that agreement.
##        Copyright (c) 2001 Intel Corporation. All Rights Reserved.
##
## File    : make_exe
## Purpose : support for makefile
##
#===============================================================================
!INCLUDE fftf.lst

build: install $T

exe: $(FFT_AUX) $(E:+=.exe)

res: exe $(E:+=.res)

install:
	set path=%path%;..\..\..\..\$(_IA)\bin
	set lib=%lib%;..\..\..\..\$(_IA)\lib
	if not exist _results\$Y\res md _results\$Y\res
	cd _results\$Y
#------------------------------------------------------------------------------
FCOMPILER = fl32 /threads /map /exe
CCOMPILER = cl /Gz

!  IF "$F"=="intel"
FCOMPILER = ifl /w /MT /Fm /Fe
CCOMPILER = icl
!  ELSEIF "$F"=="intel64"
FCOMPILER = efl /w /MT /Fm /Fe
CCOMPILER = ecl
!  ENDIF
#------------------------------------------------------------------------------
.SUFFIXES:: .c .f .obj .exe .res

{..\..\source}.c.obj:
	$(CCOMPILER) /c /w /MT /D$(_IA) $<

{..\..\source}.f.exe:
	$(FCOMPILER) $< $(FFT_AUX) ..\..\source\log2.f $(MKL_LIB:+=.lib)

.exe.res:
	$<  <..\..\in\$(@B).in
	if exist $(@B).s?? copy $(@B).s?? res & del $(@B).s??
	if exist work.* del /q work.*
